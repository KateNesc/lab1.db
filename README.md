# РГР з дисципліни "Бази Даних": Система резервування квитків

Це розрахунково-графічна робота (РГР) з дисципліни «Бази Даних». Проект являє собою консольний додаток на Python для керування базою даних «Система резервування квитків на заходи».

Додаток реалізовано згідно з шаблоном **MVC (Model-View-Controller)** та використовує СУБД **PostgreSQL** для зберігання даних. Взаємодія з базою даних відбувається через "чисті" SQL-запити за допомогою бібліотеки `Psycopg 3`, без використання ORM.

## Схема Бази Даних

База даних, спроектована у Лабораторній роботі №1, складається з чотирьох основних сутностей:

* **User**: Зберігає дані користувачів (ім’я, прізвище, email, телефон).
* **Event**: Зберігає дані про заходи (назва, дата, місце).
* **Ticket**: Зберігає квитки, прив'язані до конкретного заходу (через `event_id`).
* **Reservation**: Зв'язуюча таблиця, що поєднує `user_id` та `ticket_id` для фіксації факту бронювання.

## Функціонал програми

Додаток реалізує всі основні вимоги РГР:

1.  **Повний CRUD:**
    * Реалізовано можливість додавати, переглядати, редагувати та видаляти (`CRUD`) записи для всіх чотирьох таблиць: `User`, `Event`, `Ticket` та `Reservation`.

2.  **Управління цілісністю (Вимога №1):**
    * **Обробка помилок `ForeignKeyViolation`:** Програма коректно блокує видалення "батьківських" записів, якщо на них існують посилання в дочірніх таблицях (наприклад, неможливо видалити `User`, якщо у нього є активні `Reservation`).
    * **Контроль при введенні:** Програма перевіряє існування зовнішніх ключів перед створенням нового запису (наприклад, неможливо додати `Ticket` для неіснуючого `event_id`).

3.  **Транзакції:**
    * Складні бізнес-операції, як-от створення бронювання (`INSERT` в `Reservation` та `UPDATE` `Ticket.status`) або його скасування (`DELETE` з `Reservation` та `UPDATE` `Ticket.status`), реалізовані як атомарні транзакції.

4.  **Пакетна генерація даних (Вимога №2):**
    * Реалізовано інструментарій для пакетної генерації N-кількості випадкових даних для всіх таблиць.
    * Генерація відбувається виключно на боці сервера **PostgreSQL** за допомогою SQL-запитів (`generate_series`, `random()`, `array_agg` тощо), як того вимагає завдання.

5.  **Комплексний пошук (Вимога №3):**
    * Реалізовано 3 складні пошукові запити, що об'єднують дані з 2-4 таблиць.
    * Пошук **динамічно будує SQL-запит**, дозволяючи користувачу фільтрувати дані за декількома критеріями: діапазони дат, діапазони чисел (ціна, місце) та рядкові шаблони (`ILIKE`).
    * Запити використовують `GROUP BY` для агрегації результатів.
    * Програма вимірює та виводить **час виконання** кожного пошукового запиту в мілісекундах.

6.  **Інструменти:**
    * Додано функцію повного очищення бази даних (`TRUNCATE ... RESTART IDENTITY CASCADE`) для зручного тестування генерації.

## Технології

* **Мова:** Python 3.12
* **СУБД:** PostgreSQL
* **Драйвер:** Psycopg 3 (без ORM)
* **Архітектура:** MVC (Model-View-Controller)

## Автор

* **Студентка:** Несчетна Катерина
* **Група:** КВ-32
* **Університет:** НТУУ «КПІ ім. Ігоря Сікорського»
* **Дисципліна:** «Бази Даних»
* **Рік:** 2025